# -*- coding: utf-8 -*-
"""app.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/183nTB9Erqy3RDT_MAEfxrSvXTo63axt9
"""

# 1. app.py
code =
import streamlit as st
import pandas as pd
from analyzer import get_keywords, draw_wordcloud

st.title("ğŸ’¬ ë©´ë‹´ ë°ì´í„° ìë™ ë¶„ì„ê¸°")

uploaded_file = st.file_uploader("ğŸ“‚ ë©´ë‹´ ë°ì´í„° Excel íŒŒì¼ ì—…ë¡œë“œ", type=["xlsx"])

if uploaded_file is not None:
    df = pd.read_excel(uploaded_file)
    st.subheader("ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°")
    st.dataframe(df.head())

    selected_col = st.selectbox("ğŸ” ë¶„ì„í•  ì»¬ëŸ¼ ì„ íƒ", df.columns)

    if st.button("í‚¤ì›Œë“œ ë¶„ì„ ì‹œì‘"):
        keywords_df = get_keywords(df, column=selected_col)
        st.subheader("ğŸ“Š ì£¼ìš” í‚¤ì›Œë“œ")
        st.dataframe(keywords_df.head(20))
        st.subheader("â˜ï¸ ì›Œë“œí´ë¼ìš°ë“œ")
        draw_wordcloud(keywords_df, title=f"{selected_col} í‚¤ì›Œë“œ")

with open("app.py", "w") as f:  # ë˜ëŠ” "analyzer.py"
    f.write(code)